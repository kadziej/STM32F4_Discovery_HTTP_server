

/* Includes ------------------------------------------------------------------*/
#include "lwip/opt.h"
#include "lwip/arch.h"
#include "lwip/api.h"
#include "fs.h"
#include "string.h"
#include "httpserver-netconn.h"
#include "FreeRTOS.h"
#include "task.h"

#include "stm32f4_discovery.h"

#include "sd_card.h"

/* Private typedef -----------------------------------------------------------*/
/* Private define ------------------------------------------------------------*/
#define WEBSERVER_THREAD_PRIO    ( tskIDLE_PRIORITY + 3 )

/* Private macro -------------------------------------------------------------*/
/* Private variables ---------------------------------------------------------*/
u32_t nPageHits = 0;

xQueueHandle powerontime_queue;
xQueueHandle last_sntp_response_queue;

/* Format of dynamic web page: the page header */
static const unsigned char PAGE_START[] = {
0x3c,0x21,0x44,0x4f,0x43,0x54,0x59,0x50,0x45,0x20,0x68,0x74,0x6d,0x6c,0x20,0x50,
0x55,0x42,0x4c,0x49,0x43,0x20,0x22,0x2d,0x2f,0x2f,0x57,0x33,0x43,0x2f,0x2f,0x44,
0x54,0x44,0x20,0x48,0x54,0x4d,0x4c,0x20,0x34,0x2e,0x30,0x31,0x2f,0x2f,0x45,0x4e,
0x22,0x20,0x22,0x68,0x74,0x74,0x70,0x3a,0x2f,0x2f,0x77,0x77,0x77,0x2e,0x77,0x33,
0x2e,0x6f,0x72,0x67,0x2f,0x54,0x52,0x2f,0x68,0x74,0x6d,0x6c,0x34,0x2f,0x73,0x74,
0x72,0x69,0x63,0x74,0x2e,0x64,0x74,0x64,0x22,0x3e,0x0d,0x0a,0x3c,0x68,0x74,0x6d,
0x6c,0x3e,0x0d,0x0a,0x3c,0x68,0x65,0x61,0x64,0x3e,0x0d,0x0a,0x20,0x20,0x3c,0x74,
0x69,0x74,0x6c,0x65,0x3e,0x53,0x54,0x4d,0x33,0x32,0x46,0x34,0x78,0x37,0x54,0x41,
0x53,0x4b,0x53,0x3c,0x2f,0x74,0x69,0x74,0x6c,0x65,0x3e,0x0d,0x0a,0x20,0x20,0x3c,
0x6d,0x65,0x74,0x61,0x20,0x68,0x74,0x74,0x70,0x2d,0x65,0x71,0x75,0x69,0x76,0x3d,
0x22,0x43,0x6f,0x6e,0x74,0x65,0x6e,0x74,0x2d,0x54,0x79,0x70,0x65,0x22,0x0d,0x0a,
0x20,0x63,0x6f,0x6e,0x74,0x65,0x6e,0x74,0x3d,0x22,0x74,0x65,0x78,0x74,0x2f,0x68,
0x74,0x6d,0x6c,0x3b,0x20,0x63,0x68,0x61,0x72,0x73,0x65,0x74,0x3d,0x77,0x69,0x6e,
0x64,0x6f,0x77,0x73,0x2d,0x31,0x32,0x35,0x32,0x22,0x3e,0x0d,0x0a,0x20,0x20,0x3c,
0x6d,0x65,0x74,0x61,0x20,0x68,0x74,0x74,0x70,0x2d,0x65,0x71,0x75,0x69,0x76,0x3d,
0x22,0x72,0x65,0x66,0x72,0x65,0x73,0x68,0x22,0x20,0x63,0x6f,0x6e,0x74,0x65,0x6e,
0x74,0x3d,0x22,0x31,0x22,0x3e,0x0d,0x0a,0x20,0x20,0x3c,0x6d,0x65,0x74,0x61,0x20,
0x63,0x6f,0x6e,0x74,0x65,0x6e,0x74,0x3d,0x22,0x4d,0x53,0x48,0x54,0x4d,0x4c,0x20,
0x36,0x2e,0x30,0x30,0x2e,0x32,0x38,0x30,0x30,0x2e,0x31,0x35,0x36,0x31,0x22,0x20,
0x6e,0x61,0x6d,0x65,0x3d,0x22,0x47,0x45,0x4e,0x45,0x52,0x41,0x54,0x4f,0x52,0x22,
0x3e,0x0d,0x0a,0x20,0x20,0x3c,0x73,0x74,0x79,0x6c,0x65,0x20,0x3d,0x22,0x66,0x6f,
0x6e,0x74,0x2d,0x77,0x65,0x69,0x67,0x68,0x74,0x3a,0x20,0x6e,0x6f,0x72,0x6d,0x61,
0x6c,0x3b,0x20,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x20,
0x56,0x65,0x72,0x64,0x61,0x6e,0x61,0x3b,0x22,0x3e,0x3c,0x2f,0x73,0x74,0x79,0x6c,
0x65,0x3e,0x0d,0x0a,0x3c,0x2f,0x68,0x65,0x61,0x64,0x3e,0x0d,0x0a,0x3c,0x62,0x6f,
0x64,0x79,0x3e,0x0d,0x0a,0x3c,0x68,0x34,0x3e,0x3c,0x73,0x6d,0x61,0x6c,0x6c,0x20,
0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,
0x6c,0x79,0x3a,0x20,0x56,0x65,0x72,0x64,0x61,0x6e,0x61,0x3b,0x22,0x3e,0x3c,0x73,
0x6d,0x61,0x6c,0x6c,0x3e,0x3c,0x62,0x69,0x67,0x3e,0x3c,0x62,0x69,0x67,0x3e,0x3c,
0x62,0x69,0x67,0x0d,0x0a,0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,0x66,0x6f,0x6e,
0x74,0x2d,0x77,0x65,0x69,0x67,0x68,0x74,0x3a,0x20,0x62,0x6f,0x6c,0x64,0x3b,0x22,
0x3e,0x3c,0x62,0x69,0x67,0x3e,0x3c,0x73,0x74,0x72,0x6f,0x6e,0x67,0x3e,0x3c,0x65,
0x6d,0x3e,0x3c,0x73,0x70,0x61,0x6e,0x0d,0x0a,0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,
0x22,0x66,0x6f,0x6e,0x74,0x2d,0x73,0x74,0x79,0x6c,0x65,0x3a,0x20,0x69,0x74,0x61,
0x6c,0x69,0x63,0x3b,0x22,0x3e,0x53,0x54,0x4d,0x33,0x32,0x46,0x34,0x78,0x37,0x20,
0x4c,0x69,0x73,0x74,0x20,0x6f,0x66,0x20,0x74,0x61,0x73,0x6b,0x73,0x20,0x61,0x6e,
0x64,0x0d,0x0a,0x74,0x68,0x65,0x69,0x72,0x20,0x73,0x74,0x61,0x74,0x75,0x73,0x3c,
0x2f,0x73,0x70,0x61,0x6e,0x3e,0x3c,0x2f,0x65,0x6d,0x3e,0x3c,0x2f,0x73,0x74,0x72,
0x6f,0x6e,0x67,0x3e,0x3c,0x2f,0x62,0x69,0x67,0x3e,0x3c,0x2f,0x62,0x69,0x67,0x3e,
0x3c,0x2f,0x62,0x69,0x67,0x3e,0x3c,0x2f,0x62,0x69,0x67,0x3e,0x3c,0x2f,0x73,0x6d,
0x61,0x6c,0x6c,0x3e,0x3c,0x2f,0x73,0x6d,0x61,0x6c,0x6c,0x3e,0x3c,0x2f,0x68,0x34,
0x3e,0x0d,0x0a,0x3c,0x68,0x72,0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,0x77,0x69,
0x64,0x74,0x68,0x3a,0x20,0x31,0x30,0x30,0x25,0x3b,0x20,0x68,0x65,0x69,0x67,0x68,
0x74,0x3a,0x20,0x32,0x70,0x78,0x3b,0x22,0x3e,0x3c,0x73,0x70,0x61,0x6e,0x0d,0x0a,
0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,0x66,0x6f,0x6e,0x74,0x2d,0x77,0x65,0x69,
0x67,0x68,0x74,0x3a,0x20,0x62,0x6f,0x6c,0x64,0x3b,0x22,0x3e,0x0d,0x0a,0x3c,0x2f,
0x73,0x70,0x61,0x6e,0x3e,0x3c,0x73,0x70,0x61,0x6e,0x20,0x73,0x74,0x79,0x6c,0x65,
0x3d,0x22,0x66,0x6f,0x6e,0x74,0x2d,0x77,0x65,0x69,0x67,0x68,0x74,0x3a,0x20,0x62,
0x6f,0x6c,0x64,0x3b,0x22,0x3e,0x0d,0x0a,0x3c,0x74,0x61,0x62,0x6c,0x65,0x20,0x73,
0x74,0x79,0x6c,0x65,0x3d,0x22,0x77,0x69,0x64,0x74,0x68,0x3a,0x20,0x39,0x36,0x31,
0x70,0x78,0x3b,0x20,0x68,0x65,0x69,0x67,0x68,0x74,0x3a,0x20,0x33,0x30,0x70,0x78,
0x3b,0x22,0x20,0x62,0x6f,0x72,0x64,0x65,0x72,0x3d,0x22,0x31,0x22,0x0d,0x0a,0x20,
0x63,0x65,0x6c,0x6c,0x70,0x61,0x64,0x64,0x69,0x6e,0x67,0x3d,0x22,0x32,0x22,0x20,
0x63,0x65,0x6c,0x6c,0x73,0x70,0x61,0x63,0x69,0x6e,0x67,0x3d,0x22,0x32,0x22,0x3e,
0x0d,0x0a,0x20,0x20,0x3c,0x74,0x62,0x6f,0x64,0x79,0x3e,0x0d,0x0a,0x20,0x20,0x20,
0x20,0x3c,0x74,0x72,0x3e,0x0d,0x0a,0x20,0x20,0x20,0x20,0x20,0x20,0x3c,0x74,0x64,
0x0d,0x0a,0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,0x66,0x6f,0x6e,0x74,0x2d,0x66,
0x61,0x6d,0x69,0x6c,0x79,0x3a,0x20,0x56,0x65,0x72,0x64,0x61,0x6e,0x61,0x3b,0x20,
0x66,0x6f,0x6e,0x74,0x2d,0x77,0x65,0x69,0x67,0x68,0x74,0x3a,0x20,0x62,0x6f,0x6c,
0x64,0x3b,0x20,0x66,0x6f,0x6e,0x74,0x2d,0x73,0x74,0x79,0x6c,0x65,0x3a,0x20,0x69,
0x74,0x61,0x6c,0x69,0x63,0x3b,0x20,0x62,0x61,0x63,0x6b,0x67,0x72,0x6f,0x75,0x6e,
0x64,0x2d,0x63,0x6f,0x6c,0x6f,0x72,0x3a,0x20,0x72,0x67,0x62,0x28,0x35,0x31,0x2c,
0x20,0x35,0x31,0x2c,0x20,0x32,0x35,0x35,0x29,0x3b,0x20,0x74,0x65,0x78,0x74,0x2d,
0x61,0x6c,0x69,0x67,0x6e,0x3a,0x20,0x63,0x65,0x6e,0x74,0x65,0x72,0x3b,0x22,0x3e,
0x3c,0x73,0x6d,0x61,0x6c,0x6c,0x3e,0x3c,0x61,0x0d,0x0a,0x20,0x68,0x72,0x65,0x66,
0x3d,0x22,0x2f,0x53,0x54,0x4d,0x33,0x32,0x46,0x34,0x78,0x37,0x2e,0x68,0x74,0x6d,
0x6c,0x22,0x3e,0x3c,0x73,0x70,0x61,0x6e,0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,
0x63,0x6f,0x6c,0x6f,0x72,0x3a,0x20,0x77,0x68,0x69,0x74,0x65,0x3b,0x22,0x3e,0x48,
0x6f,0x6d,0x65,0x0d,0x0a,0x70,0x61,0x67,0x65,0x3c,0x2f,0x73,0x70,0x61,0x6e,0x3e,
0x3c,0x2f,0x61,0x3e,0x3c,0x2f,0x73,0x6d,0x61,0x6c,0x6c,0x3e,0x3c,0x2f,0x74,0x64,
0x3e,0x0d,0x0a,0x20,0x20,0x20,0x20,0x20,0x20,0x3c,0x74,0x64,0x0d,0x0a,0x20,0x73,
0x74,0x79,0x6c,0x65,0x3d,0x22,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,
0x79,0x3a,0x20,0x56,0x65,0x72,0x64,0x61,0x6e,0x61,0x3b,0x20,0x66,0x6f,0x6e,0x74,
0x2d,0x77,0x65,0x69,0x67,0x68,0x74,0x3a,0x20,0x62,0x6f,0x6c,0x64,0x3b,0x20,0x66,
0x6f,0x6e,0x74,0x2d,0x73,0x74,0x79,0x6c,0x65,0x3a,0x20,0x69,0x74,0x61,0x6c,0x69,
0x63,0x3b,0x20,0x62,0x61,0x63,0x6b,0x67,0x72,0x6f,0x75,0x6e,0x64,0x2d,0x63,0x6f,
0x6c,0x6f,0x72,0x3a,0x20,0x72,0x67,0x62,0x28,0x35,0x31,0x2c,0x20,0x35,0x31,0x2c,
0x20,0x32,0x35,0x35,0x29,0x3b,0x20,0x74,0x65,0x78,0x74,0x2d,0x61,0x6c,0x69,0x67,
0x6e,0x3a,0x20,0x63,0x65,0x6e,0x74,0x65,0x72,0x3b,0x22,0x3e,0x3c,0x61,0x0d,0x0a,
0x20,0x68,0x72,0x65,0x66,0x3d,0x22,0x53,0x54,0x4d,0x33,0x32,0x46,0x34,0x78,0x37,
0x41,0x44,0x43,0x2e,0x68,0x74,0x6d,0x6c,0x22,0x3e,0x3c,0x73,0x70,0x61,0x6e,0x20,
0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,0x66,0x6f,0x6e,0x74,0x2d,0x77,0x65,0x69,0x67,
0x68,0x74,0x3a,0x20,0x62,0x6f,0x6c,0x64,0x3b,0x22,0x3e,0x3c,0x2f,0x73,0x70,0x61,
0x6e,0x3e,0x3c,0x2f,0x61,0x3e,0x3c,0x73,0x6d,0x61,0x6c,0x6c,0x3e,0x3c,0x61,0x0d,
0x0a,0x20,0x68,0x72,0x65,0x66,0x3d,0x22,0x2f,0x53,0x54,0x4d,0x33,0x32,0x46,0x34,
0x78,0x37,0x54,0x41,0x53,0x4b,0x53,0x2e,0x68,0x74,0x6d,0x6c,0x22,0x3e,0x3c,0x73,
0x70,0x61,0x6e,0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,0x63,0x6f,0x6c,0x6f,0x72,
0x3a,0x20,0x77,0x68,0x69,0x74,0x65,0x3b,0x22,0x3e,0x4c,0x69,0x73,0x74,0x0d,0x0a,
0x6f,0x66,0x20,0x74,0x61,0x73,0x6b,0x73,0x3c,0x2f,0x73,0x70,0x61,0x6e,0x3e,0x3c,
0x2f,0x61,0x3e,0x3c,0x2f,0x73,0x6d,0x61,0x6c,0x6c,0x3e,0x3c,0x2f,0x74,0x64,0x3e,
0x0d,0x0a,0x20,0x20,0x20,0x20,0x3c,0x2f,0x74,0x72,0x3e,0x0d,0x0a,0x20,0x20,0x3c,
0x2f,0x74,0x62,0x6f,0x64,0x79,0x3e,0x0d,0x0a,0x3c,0x2f,0x74,0x61,0x62,0x6c,0x65,
0x3e,0x0d,0x0a,0x3c,0x62,0x72,0x3e,0x0d,0x0a,0x3c,0x2f,0x73,0x70,0x61,0x6e,0x3e,
0x3c,0x73,0x70,0x61,0x6e,0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,0x66,0x6f,0x6e,
0x74,0x2d,0x77,0x65,0x69,0x67,0x68,0x74,0x3a,0x20,0x62,0x6f,0x6c,0x64,0x3b,0x22,
0x3e,0x3c,0x2f,0x73,0x70,0x61,0x6e,0x3e,0x3c,0x73,0x6d,0x61,0x6c,0x6c,0x3e,0x3c,
0x73,0x70,0x61,0x6e,0x0d,0x0a,0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,0x66,0x6f,
0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x20,0x56,0x65,0x72,0x64,0x61,
0x6e,0x61,0x3b,0x22,0x3e,0x4e,0x75,0x6d,0x62,0x65,0x72,0x20,0x6f,0x66,0x20,0x70,
0x61,0x67,0x65,0x20,0x68,0x69,0x74,0x73,0x3a,0x0d,0x0a,0x00};



static const unsigned char MY_PAGE_START[] = {
		0x3C, 0x68, 0x74, 0x6D, 0x6C, 0x20, 0x78, 0x6D, 0x6C, 0x6E, 0x73, 0x3D, 0x22, 0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F, 0x77, 0x77, 0x77, 0x2E, 0x77, 0x33, 0x2E, 0x6F, 0x72, 0x67, 0x2F, 0x31, 0x39, 0x39, 0x39, 0x2F, 0x78, 0x68, 0x74, 0x6D, 0x6C, 0x22, 0x3E, 0x0A, 0x3C, 0x68, 0x65, 0x61, 0x64, 0x3E, 0x0A, 0x3C, 0x6D, 0x65, 0x74, 0x61, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x76, 0x69, 0x65, 0x77, 0x70, 0x6F, 0x72, 0x74, 0x22, 0x20, 0x63, 0x6F, 0x6E, 0x74, 0x65, 0x6E, 0x74, 0x3D, 0x22, 0x77, 0x69, 0x64, 0x74, 0x68, 0x3D, 0x31, 0x30, 0x32, 0x34, 0x22, 0x20, 0x2F, 0x3E, 0x0A, 0x3C, 0x6D, 0x65, 0x74, 0x61, 0x20, 0x68, 0x74, 0x74, 0x70, 0x2D, 0x65, 0x71, 0x75, 0x69, 0x76, 0x3D, 0x22, 0x43, 0x6F, 0x6E, 0x74, 0x65, 0x6E, 0x74, 0x2D, 0x54, 0x79, 0x70, 0x65, 0x22, 0x20, 0x63, 0x6F, 0x6E, 0x74, 0x65, 0x6E, 0x74, 0x3D, 0x22, 0x74, 0x65, 0x78, 0x74, 0x2F, 0x68, 0x74, 0x6D, 0x6C, 0x3B, 0x20, 0x63, 0x68, 0x61, 0x72, 0x73, 0x65, 0x74, 0x3D, 0x55, 0x54, 0x46, 0x2D, 0x38, 0x22, 0x20, 0x2F, 0x3E, 0x0A, 0x3C, 0x74, 0x69, 0x74, 0x6C, 0x65, 0x3E, 0x53, 0x54, 0x4D, 0x33, 0x32, 0x46, 0x34, 0x20, 0x44, 0x69, 0x73, 0x63, 0x6F, 0x76, 0x65, 0x72, 0x79, 0x20, 0x2D, 0x20, 0x48, 0x6F, 0x6D, 0x65, 0x20, 0x53, 0x65, 0x72, 0x76, 0x65, 0x72, 0x3C, 0x2F, 0x74, 0x69, 0x74, 0x6C, 0x65, 0x3E, 0x0A, 0x3C, 0x73, 0x74, 0x79, 0x6C, 0x65, 0x3E, 0x0A, 0x2A, 0x20, 0x7B, 0x09, 0x0A, 0x09, 0x6D, 0x61, 0x72, 0x67, 0x69, 0x6E, 0x3A, 0x20, 0x30, 0x3B, 0x09, 0x0A, 0x09, 0x70, 0x61, 0x64, 0x64, 0x69, 0x6E, 0x67, 0x3A, 0x20, 0x30, 0x3B, 0x0A, 0x09, 0x6C, 0x69, 0x6E, 0x65, 0x2D, 0x68, 0x65, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x31, 0x2E, 0x36, 0x3B, 0x0A, 0x09, 0x62, 0x6F, 0x72, 0x64, 0x65, 0x72, 0x2D, 0x72, 0x61, 0x64, 0x69, 0x75, 0x73, 0x3A, 0x20, 0x34, 0x70, 0x78, 0x3B, 0x0A, 0x7D, 0x0A, 0x69, 0x6D, 0x67, 0x20, 0x7B, 0x09, 0x0A, 0x09, 0x6D, 0x61, 0x78, 0x2D, 0x77, 0x69, 0x64, 0x74, 0x68, 0x3A, 0x20, 0x31, 0x30, 0x30, 0x25, 0x3B, 0x20, 0x0A, 0x09, 0x7D, 0x0A, 0x0A, 0x62, 0x6F, 0x64, 0x79, 0x20, 0x7B, 0x09, 0x2D, 0x77, 0x65, 0x62, 0x6B, 0x69, 0x74, 0x2D, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x73, 0x6D, 0x6F, 0x6F, 0x74, 0x68, 0x69, 0x6E, 0x67, 0x3A, 0x20, 0x61, 0x6E, 0x74, 0x69, 0x61, 0x6C, 0x69, 0x61, 0x73, 0x65, 0x64, 0x3B, 0x20, 0x0A, 0x2D, 0x77, 0x65, 0x62, 0x6B, 0x69, 0x74, 0x2D, 0x74, 0x65, 0x78, 0x74, 0x2D, 0x73, 0x69, 0x7A, 0x65, 0x2D, 0x61, 0x64, 0x6A, 0x75, 0x73, 0x74, 0x3A, 0x20, 0x6E, 0x6F, 0x6E, 0x65, 0x3B, 0x09, 0x77, 0x69, 0x64, 0x74, 0x68, 0x3A, 0x20, 0x31, 0x30, 0x30, 0x25, 0x21, 0x69, 0x6D, 0x70, 0x6F, 0x72, 0x74, 0x61, 0x6E, 0x74, 0x3B, 0x09, 0x68, 0x65, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x31, 0x30, 0x30, 0x25, 0x3B, 0x0A, 0x0A, 0x0A, 0x7D, 0x0A, 0x0A, 0x61, 0x20, 0x7B, 0x09, 0x0A, 0x63, 0x6F, 0x6C, 0x6F, 0x72, 0x3A, 0x20, 0x23, 0x33, 0x34, 0x38, 0x65, 0x64, 0x61, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x0A, 0x68, 0x31, 0x2C, 0x20, 0x68, 0x32, 0x2C, 0x20, 0x68, 0x33, 0x20, 0x7B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x77, 0x65, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x6E, 0x6F, 0x72, 0x6D, 0x61, 0x6C, 0x3B, 0x20, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x66, 0x61, 0x6D, 0x69, 0x6C, 0x79, 0x3A, 0x20, 0x56, 0x65, 0x72, 0x64, 0x61, 0x6E, 0x61, 0x3B, 0x0A, 0x09, 0x6C, 0x69, 0x6E, 0x65, 0x2D, 0x68, 0x65, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x31, 0x2E, 0x31, 0x3B, 0x0A, 0x09, 0x6D, 0x61, 0x72, 0x67, 0x69, 0x6E, 0x2D, 0x62, 0x6F, 0x74, 0x74, 0x6F, 0x6D, 0x3A, 0x20, 0x31, 0x35, 0x70, 0x78, 0x3B, 0x0A, 0x09, 0x63, 0x6F, 0x6C, 0x6F, 0x72, 0x3A, 0x20, 0x23, 0x30, 0x30, 0x30, 0x3B, 0x0A, 0x09, 0x6D, 0x61, 0x72, 0x67, 0x69, 0x6E, 0x3A, 0x20, 0x34, 0x30, 0x70, 0x78, 0x20, 0x30, 0x20, 0x31, 0x30, 0x70, 0x78, 0x3B, 0x0A, 0x09, 0x6C, 0x69, 0x6E, 0x65, 0x2D, 0x68, 0x65, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x31, 0x2E, 0x32, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x68, 0x31, 0x20, 0x7B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x73, 0x69, 0x7A, 0x65, 0x3A, 0x20, 0x33, 0x36, 0x70, 0x78, 0x3B, 0x0A, 0x7D, 0x0A, 0x68, 0x32, 0x20, 0x7B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x73, 0x69, 0x7A, 0x65, 0x3A, 0x20, 0x32, 0x38, 0x70, 0x78, 0x3B, 0x0A, 0x7D, 0x0A, 0x68, 0x33, 0x20, 0x7B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x73, 0x69, 0x7A, 0x65, 0x3A, 0x20, 0x32, 0x32, 0x70, 0x78, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x23, 0x63, 0x6F, 0x6E, 0x74, 0x61, 0x69, 0x6E, 0x65, 0x72, 0x0A, 0x7B, 0x0A, 0x0A, 0x09, 0x6D, 0x61, 0x72, 0x67, 0x69, 0x6E, 0x3A, 0x20, 0x30, 0x20, 0x61, 0x75, 0x74, 0x6F, 0x3B, 0x0A, 0x09, 0x77, 0x69, 0x64, 0x74, 0x68, 0x3A, 0x20, 0x31, 0x30, 0x32, 0x34, 0x70, 0x78, 0x3B, 0x0A, 0x09, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x66, 0x66, 0x66, 0x3B, 0x0A, 0x09, 0x0A, 0x7D, 0x0A, 0x0A, 0x23, 0x68, 0x65, 0x61, 0x64, 0x65, 0x72, 0x0A, 0x7B, 0x0A, 0x0A, 0x09, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x65, 0x65, 0x65, 0x3B, 0x0A, 0x09, 0x70, 0x61, 0x64, 0x64, 0x69, 0x6E, 0x67, 0x3A, 0x20, 0x31, 0x30, 0x70, 0x78, 0x3B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x66, 0x61, 0x6D, 0x69, 0x6C, 0x79, 0x3A, 0x20, 0x56, 0x65, 0x72, 0x64, 0x61, 0x6E, 0x61, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x23, 0x68, 0x65, 0x61, 0x64, 0x65, 0x72, 0x20, 0x68, 0x31, 0x20, 0x7B, 0x20, 0x6D, 0x61, 0x72, 0x67, 0x69, 0x6E, 0x3A, 0x20, 0x30, 0x3B, 0x20, 0x7D, 0x0A, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x0A, 0x7B, 0x0A, 0x09, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x3A, 0x20, 0x6C, 0x65, 0x66, 0x74, 0x3B, 0x0A, 0x09, 0x77, 0x69, 0x64, 0x74, 0x68, 0x3A, 0x20, 0x31, 0x30, 0x32, 0x34, 0x70, 0x78, 0x3B, 0x0A, 0x09, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x35, 0x35, 0x35, 0x3B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x66, 0x61, 0x6D, 0x69, 0x6C, 0x79, 0x3A, 0x20, 0x56, 0x65, 0x72, 0x64, 0x61, 0x6E, 0x61, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x20, 0x75, 0x6C, 0x0A, 0x7B, 0x0A, 0x09, 0x6D, 0x61, 0x72, 0x67, 0x69, 0x6E, 0x3A, 0x20, 0x30, 0x3B, 0x0A, 0x09, 0x70, 0x61, 0x64, 0x64, 0x69, 0x6E, 0x67, 0x3A, 0x20, 0x30, 0x3B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x77, 0x65, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x6E, 0x6F, 0x72, 0x6D, 0x61, 0x6C, 0x3B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x73, 0x69, 0x7A, 0x65, 0x3A, 0x20, 0x31, 0x38, 0x70, 0x78, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x20, 0x75, 0x6C, 0x20, 0x6C, 0x69, 0x0A, 0x7B, 0x0A, 0x09, 0x6C, 0x69, 0x73, 0x74, 0x2D, 0x73, 0x74, 0x79, 0x6C, 0x65, 0x2D, 0x74, 0x79, 0x70, 0x65, 0x3A, 0x20, 0x6E, 0x6F, 0x6E, 0x65, 0x3B, 0x0A, 0x09, 0x64, 0x69, 0x73, 0x70, 0x6C, 0x61, 0x79, 0x3A, 0x20, 0x69, 0x6E, 0x6C, 0x69, 0x6E, 0x65, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x20, 0x6C, 0x69, 0x20, 0x61, 0x0A, 0x7B, 0x0A, 0x09, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x33, 0x33, 0x33, 0x3B, 0x0A, 0x09, 0x74, 0x65, 0x78, 0x74, 0x2D, 0x64, 0x65, 0x63, 0x6F, 0x72, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x3A, 0x20, 0x6E, 0x6F, 0x6E, 0x65, 0x3B, 0x0A, 0x09, 0x63, 0x6F, 0x6C, 0x6F, 0x72, 0x3A, 0x23, 0x66, 0x66, 0x66, 0x3B, 0x0A, 0x09, 0x64, 0x69, 0x73, 0x70, 0x6C, 0x61, 0x79, 0x3A, 0x20, 0x62, 0x6C, 0x6F, 0x63, 0x6B, 0x3B, 0x0A, 0x09, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x3A, 0x20, 0x6C, 0x65, 0x66, 0x74, 0x3B, 0x0A, 0x09, 0x70, 0x61, 0x64, 0x64, 0x69, 0x6E, 0x67, 0x3A, 0x20, 0x31, 0x30, 0x70, 0x78, 0x20, 0x32, 0x30, 0x70, 0x78, 0x3B, 0x0A, 0x09, 0x62, 0x6F, 0x72, 0x64, 0x65, 0x72, 0x2D, 0x72, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x32, 0x70, 0x78, 0x20, 0x73, 0x6F, 0x6C, 0x69, 0x64, 0x23, 0x64, 0x64, 0x64, 0x3B, 0x0A, 0x7D, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x20, 0x6C, 0x69, 0x20, 0x70, 0x0A, 0x7B, 0x0A, 0x09, 0x74, 0x65, 0x78, 0x74, 0x2D, 0x64, 0x65, 0x63, 0x6F, 0x72, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x3A, 0x20, 0x6E, 0x6F, 0x6E, 0x65, 0x3B, 0x0A, 0x09, 0x63, 0x6F, 0x6C, 0x6F, 0x72, 0x3A, 0x23, 0x66, 0x66, 0x66, 0x3B, 0x0A, 0x09, 0x64, 0x69, 0x73, 0x70, 0x6C, 0x61, 0x79, 0x3A, 0x20, 0x62, 0x6C, 0x6F, 0x63, 0x6B, 0x3B, 0x0A, 0x09, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x3A, 0x20, 0x6C, 0x65, 0x66, 0x74, 0x3B, 0x0A, 0x09, 0x70, 0x61, 0x64, 0x64, 0x69, 0x6E, 0x67, 0x3A, 0x20, 0x31, 0x30, 0x70, 0x78, 0x20, 0x32, 0x30, 0x70, 0x78, 0x3B, 0x0A, 0x09, 0x62, 0x6F, 0x72, 0x64, 0x65, 0x72, 0x2D, 0x72, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x31, 0x70, 0x78, 0x20, 0x73, 0x6F, 0x6C, 0x69, 0x64, 0x23, 0x66, 0x66, 0x66, 0x3B, 0x0A, 0x09, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x33, 0x38, 0x33, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x20, 0x6C, 0x69, 0x20, 0x61, 0x3A, 0x68, 0x6F, 0x76, 0x65, 0x72, 0x20, 0x7B, 0x20, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x33, 0x38, 0x33, 0x3B, 0x20, 0x7D, 0x0A, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x32, 0x0A, 0x7B, 0x0A, 0x0A, 0x09, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x3A, 0x20, 0x6C, 0x65, 0x66, 0x74, 0x3B, 0x0A, 0x09, 0x77, 0x69, 0x64, 0x74, 0x68, 0x3A, 0x20, 0x31, 0x30, 0x30, 0x25, 0x3B, 0x0A, 0x09, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x43, 0x43, 0x43, 0x3B, 0x0A, 0x7D, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x32, 0x20, 0x75, 0x6C, 0x0A, 0x7B, 0x0A, 0x0A, 0x09, 0x6D, 0x61, 0x72, 0x67, 0x69, 0x6E, 0x3A, 0x20, 0x30, 0x3B, 0x0A, 0x09, 0x70, 0x61, 0x64, 0x64, 0x69, 0x6E, 0x67, 0x3A, 0x20, 0x30, 0x3B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x77, 0x65, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x6E, 0x6F, 0x72, 0x6D, 0x61, 0x6C, 0x3B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x73, 0x69, 0x7A, 0x65, 0x3A, 0x20, 0x31, 0x34, 0x70, 0x78, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x32, 0x20, 0x75, 0x6C, 0x20, 0x6C, 0x69, 0x0A, 0x7B, 0x0A, 0x0A, 0x09, 0x6C, 0x69, 0x73, 0x74, 0x2D, 0x73, 0x74, 0x79, 0x6C, 0x65, 0x2D, 0x74, 0x79, 0x70, 0x65, 0x3A, 0x20, 0x6E, 0x6F, 0x6E, 0x65, 0x3B, 0x0A, 0x09, 0x64, 0x69, 0x73, 0x70, 0x6C, 0x61, 0x79, 0x3A, 0x20, 0x69, 0x6E, 0x6C, 0x69, 0x6E, 0x65, 0x3B, 0x0A, 0x09, 0x0A, 0x09, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x42, 0x42, 0x42, 0x3B, 0x0A, 0x09, 0x74, 0x65, 0x78, 0x74, 0x2D, 0x64, 0x65, 0x63, 0x6F, 0x72, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x3A, 0x20, 0x6E, 0x6F, 0x6E, 0x65, 0x3B, 0x0A, 0x09, 0x63, 0x6F, 0x6C, 0x6F, 0x72, 0x3A, 0x23, 0x66, 0x66, 0x66, 0x3B, 0x0A, 0x09, 0x64, 0x69, 0x73, 0x70, 0x6C, 0x61, 0x79, 0x3A, 0x20, 0x62, 0x6C, 0x6F, 0x63, 0x6B, 0x3B, 0x0A, 0x09, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x3A, 0x20, 0x6C, 0x65, 0x66, 0x74, 0x3B, 0x0A, 0x0A, 0x09, 0x62, 0x6F, 0x72, 0x64, 0x65, 0x72, 0x2D, 0x72, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x32, 0x70, 0x78, 0x20, 0x73, 0x6F, 0x6C, 0x69, 0x64, 0x23, 0x66, 0x66, 0x66, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x32, 0x20, 0x6C, 0x69, 0x20, 0x61, 0x0A, 0x7B, 0x0A, 0x09, 0x74, 0x65, 0x78, 0x74, 0x2D, 0x64, 0x65, 0x63, 0x6F, 0x72, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x3A, 0x20, 0x6E, 0x6F, 0x6E, 0x65, 0x3B, 0x0A, 0x09, 0x64, 0x69, 0x73, 0x70, 0x6C, 0x61, 0x79, 0x3A, 0x20, 0x62, 0x6C, 0x6F, 0x63, 0x6B, 0x3B, 0x0A, 0x09, 0x63, 0x6F, 0x6C, 0x6F, 0x72, 0x3A, 0x23, 0x66, 0x66, 0x66, 0x3B, 0x0A, 0x09, 0x70, 0x61, 0x64, 0x64, 0x69, 0x6E, 0x67, 0x3A, 0x20, 0x35, 0x70, 0x78, 0x20, 0x32, 0x30, 0x70, 0x78, 0x3B, 0x0A, 0x7D, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x32, 0x20, 0x6C, 0x69, 0x20, 0x70, 0x0A, 0x7B, 0x0A, 0x09, 0x74, 0x65, 0x78, 0x74, 0x2D, 0x64, 0x65, 0x63, 0x6F, 0x72, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x3A, 0x20, 0x6E, 0x6F, 0x6E, 0x65, 0x3B, 0x0A, 0x09, 0x63, 0x6F, 0x6C, 0x6F, 0x72, 0x3A, 0x23, 0x66, 0x66, 0x66, 0x3B, 0x0A, 0x09, 0x64, 0x69, 0x73, 0x70, 0x6C, 0x61, 0x79, 0x3A, 0x20, 0x62, 0x6C, 0x6F, 0x63, 0x6B, 0x3B, 0x0A, 0x09, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x3A, 0x20, 0x6C, 0x65, 0x66, 0x74, 0x3B, 0x0A, 0x09, 0x70, 0x61, 0x64, 0x64, 0x69, 0x6E, 0x67, 0x3A, 0x20, 0x35, 0x70, 0x78, 0x20, 0x32, 0x30, 0x70, 0x78, 0x3B, 0x0A, 0x0A, 0x09, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x33, 0x38, 0x33, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x32, 0x20, 0x6C, 0x69, 0x20, 0x64, 0x0A, 0x7B, 0x0A, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x77, 0x65, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x6E, 0x6F, 0x72, 0x6D, 0x61, 0x6C, 0x3B, 0x0A, 0x09, 0x74, 0x65, 0x78, 0x74, 0x2D, 0x64, 0x65, 0x63, 0x6F, 0x72, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x3A, 0x20, 0x6E, 0x6F, 0x6E, 0x65, 0x3B, 0x0A, 0x09, 0x63, 0x6F, 0x6C, 0x6F, 0x72, 0x3A, 0x23, 0x33, 0x33, 0x33, 0x3B, 0x0A, 0x09, 0x64, 0x69, 0x73, 0x70, 0x6C, 0x61, 0x79, 0x3A, 0x20, 0x62, 0x6C, 0x6F, 0x63, 0x6B, 0x3B, 0x0A, 0x09, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x3A, 0x20, 0x6C, 0x65, 0x66, 0x74, 0x3B, 0x0A, 0x09, 0x70, 0x61, 0x64, 0x64, 0x69, 0x6E, 0x67, 0x3A, 0x20, 0x35, 0x70, 0x78, 0x20, 0x32, 0x30, 0x70, 0x78, 0x3B, 0x0A, 0x09, 0x62, 0x6F, 0x72, 0x64, 0x65, 0x72, 0x2D, 0x72, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x32, 0x70, 0x78, 0x20, 0x73, 0x6F, 0x6C, 0x69, 0x64, 0x23, 0x66, 0x66, 0x66, 0x3B, 0x0A, 0x09, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x43, 0x43, 0x43, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x32, 0x20, 0x6C, 0x69, 0x20, 0x72, 0x0A, 0x7B, 0x0A, 0x09, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x66, 0x38, 0x33, 0x3B, 0x0A, 0x7D, 0x0A, 0x23, 0x6E, 0x61, 0x76, 0x69, 0x67, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x32, 0x20, 0x6C, 0x69, 0x20, 0x61, 0x3A, 0x68, 0x6F, 0x76, 0x65, 0x72, 0x20, 0x7B, 0x20, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x66, 0x38, 0x33, 0x3B, 0x20, 0x7D, 0x0A, 0x0A, 0x0A, 0x23, 0x63, 0x6F, 0x6E, 0x74, 0x65, 0x6E, 0x74, 0x0A, 0x7B, 0x0A, 0x09, 0x63, 0x6C, 0x65, 0x61, 0x72, 0x3A, 0x20, 0x6C, 0x65, 0x66, 0x74, 0x3B, 0x0A, 0x09, 0x70, 0x61, 0x64, 0x64, 0x69, 0x6E, 0x67, 0x3A, 0x20, 0x32, 0x30, 0x70, 0x78, 0x3B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x77, 0x65, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x6E, 0x6F, 0x72, 0x6D, 0x61, 0x6C, 0x3B, 0x20, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x66, 0x61, 0x6D, 0x69, 0x6C, 0x79, 0x3A, 0x20, 0x56, 0x65, 0x72, 0x64, 0x61, 0x6E, 0x61, 0x3B, 0x0A, 0x09, 0x0A, 0x7D, 0x0A, 0x0A, 0x23, 0x63, 0x6F, 0x6E, 0x74, 0x65, 0x6E, 0x74, 0x20, 0x68, 0x32, 0x0A, 0x7B, 0x0A, 0x09, 0x63, 0x6F, 0x6C, 0x6F, 0x72, 0x3A, 0x23, 0x30, 0x30, 0x30, 0x3B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x73, 0x69, 0x7A, 0x65, 0x3A, 0x20, 0x31, 0x36, 0x30, 0x25, 0x3B, 0x0A, 0x09, 0x6D, 0x61, 0x72, 0x67, 0x69, 0x6E, 0x3A, 0x20, 0x30, 0x20, 0x30, 0x20, 0x2E, 0x35, 0x65, 0x6D, 0x3B, 0x0A, 0x7D, 0x0A, 0x0A, 0x23, 0x66, 0x6F, 0x6F, 0x74, 0x65, 0x72, 0x0A, 0x7B, 0x0A, 0x09, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x3A, 0x23, 0x65, 0x65, 0x65, 0x3B, 0x0A, 0x09, 0x74, 0x65, 0x78, 0x74, 0x2D, 0x61, 0x6C, 0x69, 0x67, 0x6E, 0x3A, 0x20, 0x72, 0x69, 0x67, 0x68, 0x74, 0x3B, 0x0A, 0x09, 0x70, 0x61, 0x64, 0x64, 0x69, 0x6E, 0x67, 0x3A, 0x20, 0x38, 0x70, 0x78, 0x3B, 0x0A, 0x09, 0x68, 0x65, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x32, 0x30, 0x70, 0x78, 0x3B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x66, 0x61, 0x6D, 0x69, 0x6C, 0x79, 0x3A, 0x20, 0x56, 0x65, 0x72, 0x64, 0x61, 0x6E, 0x61, 0x3B, 0x0A, 0x09, 0x66, 0x6F, 0x6E, 0x74, 0x2D, 0x73, 0x69, 0x7A, 0x65, 0x3A, 0x20, 0x31, 0x32, 0x70, 0x78, 0x3B, 0x0A, 0x7D, 0x0A, 0x3C, 0x2F, 0x73, 0x74, 0x79, 0x6C,
		0x65, 0x3E
};

static const unsigned char CHART_START[] = {
0x3C, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x20, 0x73, 0x72, 0x63, 0x3D, 0x22, 0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F,
0x2F, 0x63, 0x6F, 0x64, 0x65, 0x2E, 0x6A, 0x71, 0x75, 0x65, 0x72, 0x79, 0x2E, 0x63, 0x6F, 0x6D, 0x2F, 0x6A, 0x71,
0x75, 0x65, 0x72, 0x79, 0x2D, 0x31, 0x2E, 0x39, 0x2E, 0x31, 0x2E, 0x6A, 0x73, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x74, 0x65, 0x78, 0x74, 0x2F, 0x6A, 0x61, 0x76, 0x61, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x22, 0x3E, 0x3C, 0x2F, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x3E, 0x0A, 0x3C, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x20, 0x73, 0x72, 0x63, 0x3D, 0x22, 0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F, 0x63, 0x6F, 0x64, 0x65, 0x2E, 0x68, 0x69, 0x67, 0x68, 0x63, 0x68, 0x61, 0x72, 0x74, 0x73, 0x2E, 0x63, 0x6F, 0x6D, 0x2F, 0x68, 0x69, 0x67, 0x68, 0x63, 0x68, 0x61, 0x72, 0x74, 0x73, 0x2E, 0x6A, 0x73, 0x22, 0x3E, 0x3C, 0x2F, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x3E, 0x0A, 0x3C, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x20, 0x73, 0x72, 0x63, 0x3D, 0x22, 0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F, 0x63, 0x6F, 0x64, 0x65, 0x2E, 0x68, 0x69, 0x67, 0x68, 0x63, 0x68, 0x61, 0x72, 0x74, 0x73, 0x2E, 0x63, 0x6F, 0x6D, 0x2F, 0x6D, 0x6F, 0x64, 0x75, 0x6C, 0x65, 0x73, 0x2F, 0x65, 0x78, 0x70, 0x6F, 0x72, 0x74, 0x69, 0x6E, 0x67, 0x2E, 0x6A, 0x73, 0x22, 0x3E, 0x3C, 0x2F, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x3E, 0x0A, 0x3C, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x74, 0x65, 0x78, 0x74, 0x2F, 0x6A, 0x61, 0x76, 0x61, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x22, 0x3E, 0x0A, 0x24, 0x28, 0x66, 0x75, 0x6E, 0x63, 0x74, 0x69, 0x6F, 0x6E, 0x20, 0x28, 0x29, 0x20, 0x7B, 0x0A, 0x24, 0x28, 0x27, 0x23, 0x64, 0x69, 0x76, 0x5F, 0x63, 0x68, 0x61, 0x72, 0x74, 0x27, 0x29, 0x2E, 0x68, 0x69, 0x67, 0x68, 0x63, 0x68, 0x61, 0x72, 0x74, 0x73, 0x28, 0x7B, 0x0A, 0x63, 0x68, 0x61, 0x72, 0x74, 0x3A, 0x20, 0x7B, 0x20, 0x7A, 0x6F, 0x6F, 0x6D, 0x54, 0x79, 0x70, 0x65, 0x3A, 0x20, 0x27, 0x78, 0x27, 0x2C, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3A, 0x20, 0x27, 0x6C, 0x69, 0x6E, 0x65, 0x27, 0x7D, 0x2C, 0x20, 0x20, 0x20, 0x20, 0x20, 0x0A, 0x73, 0x75, 0x62, 0x74, 0x69, 0x74, 0x6C, 0x65, 0x3A, 0x20, 0x7B, 0x0A, 0x74, 0x65, 0x78, 0x74, 0x3A, 0x20, 0x64, 0x6F, 0x63, 0x75, 0x6D, 0x65, 0x6E, 0x74, 0x2E, 0x6F, 0x6E, 0x74, 0x6F, 0x75, 0x63, 0x68, 0x73, 0x74, 0x61, 0x72, 0x74, 0x20, 0x3D, 0x3D, 0x3D, 0x20, 0x75, 0x6E, 0x64, 0x65, 0x66, 0x69, 0x6E, 0x65, 0x64, 0x20, 0x3F, 0x0A, 0x27, 0x43, 0x6C, 0x69, 0x63, 0x6B, 0x20, 0x61, 0x6E, 0x64, 0x20, 0x64, 0x72, 0x61, 0x67, 0x20, 0x74, 0x6F, 0x20, 0x65, 0x6E, 0x6C, 0x61, 0x72, 0x67, 0x65, 0x27, 0x20, 0x3A, 0x0A, 0x27, 0x50, 0x69, 0x6E, 0x63, 0x68, 0x20, 0x74, 0x68, 0x65, 0x20, 0x63, 0x68, 0x61, 0x72, 0x74, 0x20, 0x74, 0x6F, 0x20, 0x7A, 0x6F, 0x6F, 0x6D, 0x20, 0x69, 0x6E, 0x27, 0x20, 0x7D, 0x2C, 0x0A, 0x78, 0x41, 0x78, 0x69, 0x73, 0x3A, 0x20, 0x7B, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3A, 0x20, 0x27, 0x64, 0x61, 0x74, 0x65, 0x74, 0x69, 0x6D, 0x65, 0x27, 0x20, 0x0A, 0x2C, 0x0A, 0x67, 0x72, 0x69, 0x64, 0x4C, 0x69, 0x6E, 0x65, 0x57, 0x69, 0x64, 0x74, 0x68, 0x3A, 0x20, 0x31, 0x2C, 0x0A, 0x6C, 0x61, 0x62, 0x65, 0x6C, 0x73, 0x3A, 0x20, 0x7B, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 0x74, 0x79, 0x6C, 0x65, 0x3A, 0x20, 0x7B, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x66, 0x6F, 0x6E, 0x74, 0x53, 0x69, 0x7A, 0x65, 0x3A, 0x20, 0x27, 0x31, 0x32, 0x70, 0x78, 0x27, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x7D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x7D, 0x0A, 0x0A, 0x7D, 0x2C, 0x0A, 0x79, 0x41, 0x78, 0x69, 0x73, 0x3A, 0x20, 0x7B, 0x74, 0x69, 0x74, 0x6C, 0x65, 0x3A, 0x20, 0x7B, 0x20, 0x74, 0x65, 0x78, 0x74, 0x3A, 0x20, 0x27, 0x54, 0x65, 0x6D, 0x70, 0x65, 0x72, 0x61, 0x74, 0x75, 0x72, 0x61, 0x20, 0x28, 0x5C, 0x75, 0x30, 0x30, 0x42, 0x30, 0x43, 0x29, 0x27, 0x7D, 0x2C, 0x0A, 0x6D, 0x69, 0x6E, 0x6F, 0x72, 0x54, 0x69, 0x63, 0x6B, 0x49, 0x6E, 0x74, 0x65, 0x72, 0x76, 0x61, 0x6C, 0x3A, 0x20, 0x27, 0x61, 0x75, 0x74, 0x6F, 0x27, 0x2C, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x6C, 0x61, 0x62, 0x65, 0x6C, 0x73, 0x3A, 0x20, 0x7B, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 0x74, 0x79, 0x6C, 0x65, 0x3A, 0x20, 0x7B, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x66, 0x6F, 0x6E, 0x74, 0x53, 0x69, 0x7A, 0x65, 0x3A, 0x20, 0x27, 0x31, 0x32, 0x70, 0x78, 0x27, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x7D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x7D, 0x0A, 0x7D, 0x2C, 0x20, 0x20, 0x20, 0x20, 0x0A, 0x6C, 0x65, 0x67, 0x65, 0x6E, 0x64, 0x3A, 0x20, 0x7B, 0x65, 0x6E, 0x61, 0x62, 0x6C, 0x65, 0x64, 0x3A, 0x20, 0x74, 0x72, 0x75, 0x65, 0x7D, 0x2C, 0x0A, 0x74, 0x6F, 0x6F, 0x6C, 0x74, 0x69, 0x70, 0x3A, 0x20, 0x7B, 0x20, 0x76, 0x61, 0x6C, 0x75, 0x65, 0x53, 0x75, 0x66, 0x66, 0x69, 0x78, 0x3A, 0x20, 0x27, 0x5C, 0x75, 0x30, 0x30, 0x42, 0x30, 0x43, 0x27, 0x2C, 0x0A, 0x62, 0x6F, 0x72, 0x64, 0x65, 0x72, 0x57, 0x69, 0x64, 0x74, 0x68, 0x3A, 0x20, 0x30, 0x2C, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x62, 0x61, 0x63, 0x6B, 0x67, 0x72, 0x6F, 0x75, 0x6E, 0x64, 0x43, 0x6F, 0x6C, 0x6F, 0x72, 0x3A, 0x20, 0x27, 0x72, 0x67, 0x62, 0x61, 0x28, 0x32, 0x31, 0x39, 0x2C, 0x32, 0x31, 0x39, 0x2C, 0x32, 0x31, 0x36, 0x2C, 0x30, 0x2E, 0x38, 0x29, 0x27, 0x2C, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 0x68, 0x61, 0x64, 0x6F, 0x77, 0x3A, 0x20, 0x66, 0x61, 0x6C, 0x73, 0x65, 0x2C, 0x0A, 0x09, 0x20, 0x20, 0x63, 0x72, 0x6F, 0x73, 0x73, 0x68, 0x61, 0x69, 0x72, 0x73, 0x3A, 0x20, 0x5B, 0x7B, 0x20, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x77, 0x69, 0x64, 0x74, 0x68, 0x3A, 0x20, 0x32, 0x2C, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x63, 0x6F, 0x6C, 0x6F, 0x72, 0x3A, 0x20, 0x27, 0x67, 0x72, 0x61, 0x79, 0x27, 0x2C, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x64, 0x61, 0x73, 0x68, 0x53, 0x74, 0x79, 0x6C, 0x65, 0x3A, 0x20, 0x27, 0x73, 0x68, 0x6F, 0x72, 0x74, 0x64, 0x6F, 0x74, 0x27, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x7D, 0x2C, 0x7B, 0x20, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x77, 0x69, 0x64, 0x74, 0x68, 0x3A, 0x20, 0x32, 0x2C, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x63, 0x6F, 0x6C, 0x6F, 0x72, 0x3A, 0x20, 0x27, 0x67, 0x72, 0x61, 0x79, 0x27, 0x2C, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x64, 0x61, 0x73, 0x68, 0x53, 0x74, 0x79, 0x6C, 0x65, 0x3A, 0x20, 0x27, 0x73, 0x68, 0x6F, 0x72, 0x74, 0x64, 0x6F, 0x74, 0x27, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x7D, 0x5D, 0x2C, 0x0A, 0x09, 0x20, 0x20, 0x73, 0x68, 0x61, 0x72, 0x65, 0x64, 0x3A, 0x20, 0x66, 0x61, 0x6C, 0x73, 0x65, 0x2C, 0x0A, 0x09, 0x20, 0x20, 0x78, 0x44, 0x61, 0x74, 0x65, 0x46, 0x6F, 0x72, 0x6D, 0x61, 0x74, 0x3A, 0x20, 0x27, 0x25, 0x64, 0x2D, 0x25, 0x6D, 0x2D, 0x25, 0x59, 0x20, 0x25, 0x48, 0x3A, 0x25, 0x4D, 0x27, 0x0A, 0x09, 0x20, 0x20, 0x7D, 0x2C, 0x0A, 0x63, 0x6F, 0x6C, 0x6F, 0x72, 0x73, 0x3A, 0x20, 0x5B, 0x22, 0x23, 0x37, 0x63, 0x62, 0x35, 0x65, 0x63, 0x22, 0x2C, 0x20, 0x22, 0x23, 0x66, 0x37, 0x61, 0x33, 0x35, 0x63, 0x22, 0x2C, 0x20, 0x22, 0x23, 0x39, 0x30, 0x65, 0x65, 0x37, 0x65, 0x22, 0x2C, 0x20, 0x22, 0x23, 0x37, 0x37, 0x39, 0x38, 0x42, 0x46, 0x22, 0x2C, 0x20, 0x22, 0x23, 0x61, 0x61, 0x65, 0x65, 0x65, 0x65, 0x22, 0x2C, 0x20, 0x22, 0x23, 0x66, 0x66, 0x30, 0x30, 0x36, 0x36, 0x22, 0x2C, 0x20, 0x22, 0x23, 0x65, 0x65, 0x61, 0x61, 0x65, 0x65, 0x22, 0x2C, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x22, 0x23, 0x35, 0x35, 0x42, 0x46, 0x33, 0x42, 0x22, 0x2C, 0x20, 0x22, 0x23, 0x44, 0x46, 0x35, 0x33, 0x35, 0x33, 0x22, 0x2C, 0x20, 0x22, 0x23, 0x37, 0x37, 0x39, 0x38, 0x42, 0x46, 0x22, 0x2C, 0x20, 0x22, 0x23, 0x61, 0x61, 0x65, 0x65, 0x65, 0x65, 0x22, 0x5D, 0x2C, 0x0A, 0x70, 0x6C, 0x6F, 0x74, 0x4F, 0x70, 0x74, 0x69, 0x6F, 0x6E, 0x73, 0x3A, 0x20, 0x7B, 0x0A, 0x6C, 0x69, 0x6E, 0x65, 0x3A, 0x20, 0x7B, 0x0A, 0x6C, 0x69, 0x6E, 0x65, 0x57, 0x69, 0x64, 0x74, 0x68, 0x3A, 0x20, 0x32, 0x2C, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 0x74, 0x61, 0x74, 0x65, 0x73, 0x3A, 0x20, 0x7B, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x68, 0x6F, 0x76, 0x65, 0x72, 0x3A, 0x20, 0x7B, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x6C, 0x69, 0x6E, 0x65, 0x57, 0x69, 0x64, 0x74, 0x68, 0x3A, 0x20, 0x32, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x7D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x7D, 0x2C, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x6D, 0x61, 0x72, 0x6B, 0x65, 0x72, 0x3A, 0x20, 0x7B, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x65, 0x6E, 0x61, 0x62, 0x6C, 0x65, 0x64, 0x3A, 0x20, 0x66, 0x61, 0x6C, 0x73, 0x65, 0x2C, 0x0A, 0x09, 0x09, 0x09, 0x09, 0x09, 0x72, 0x61, 0x64, 0x69, 0x75, 0x73, 0x3A, 0x20, 0x31, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x7D, 0x2C, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x7D, 0x0A, 0x7D, 0x2C, 0x0A, 0x74, 0x69, 0x74, 0x6C, 0x65, 0x3A, 0x20, 0x7B, 0x20, 0x0A, 0x73, 0x74, 0x79, 0x6C, 0x65, 0x3A, 0x20, 0x7B, 0x66, 0x6F, 0x6E, 0x74, 0x53, 0x69, 0x7A, 0x65, 0x3A, 0x20, 0x27, 0x31, 0x36, 0x70, 0x78, 0x27, 0x2C, 0x20, 0x66, 0x6F, 0x6E, 0x74, 0x57, 0x65, 0x69, 0x67, 0x68, 0x74, 0x3A, 0x20, 0x27, 0x62, 0x6F, 0x6C, 0x64, 0x27, 0x2C, 0x20, 0x74, 0x65, 0x78, 0x74, 0x54, 0x72, 0x61, 0x6E, 0x73, 0x66, 0x6F, 0x72, 0x6D, 0x3A, 0x20, 0x27, 0x75, 0x70, 0x70, 0x65, 0x72, 0x63, 0x61, 0x73, 0x65, 0x27, 0x7D, 0x2C, 0x0A, 0x74, 0x65, 0x78, 0x74, 0x3A, 0x20, 0x27, 0x57, 0x79, 0x6B, 0x72, 0x65, 0x73, 0x20, 0x74, 0x65, 0x6D, 0x70, 0x65, 0x72, 0x61, 0x74, 0x75, 0x72, 0x79, 0x27, 0x0A, 0x7D, 0x2C, 0x0A, 0x0A,
0x73, 0x65, 0x72, 0x69, 0x65, 0x73, 0x3A, 0x20, 0x5B
};
static const unsigned char download_txt_header[] = {
/* /STM32F4x7_files/logo.jpg (26 chars) */
//0x2f,0x53,0x54,0x4d,0x33,0x32,0x46,0x34,0x78,0x37,0x5f,0x66,0x69,0x6c,0x65,0x73,
//0x2f,0x6c,0x6f,0x67,0x6f,0x2e,0x6a,0x70,0x67,0x00,
0x00,0x00,

/* HTTP header */
/* "HTTP/1.0 200 OK
" (17 bytes) */
0x48,0x54,0x54,0x50,0x2f,0x31,0x2e,0x30,0x20,0x32,0x30,0x30,0x20,0x4f,0x4b,0x0d,
0x0a,
/* "Server: lwIP/1.3.1 (http://savannah.nongnu.org/projects/lwip)
" (63 bytes) */
0x53,0x65,0x72,0x76,0x65,0x72,0x3a,0x20,0x6c,0x77,0x49,0x50,0x2f,0x31,0x2e,0x33,
0x2e,0x31,0x20,0x28,0x68,0x74,0x74,0x70,0x3a,0x2f,0x2f,0x73,0x61,0x76,0x61,0x6e,
0x6e,0x61,0x68,0x2e,0x6e,0x6f,0x6e,0x67,0x6e,0x75,0x2e,0x6f,0x72,0x67,0x2f,0x70,
0x72,0x6f,0x6a,0x65,0x63,0x74,0x73,0x2f,0x6c,0x77,0x69,0x70,0x29,0x0d,0x0a,
/* "Content-type: text/plain

" (28 bytes) */
0x43,0x6F,0x6E,0x74,0x65,0x6E,0x74,0x2D,0x74,0x79,0x70,0x65,0x3A,0x20,0x74,0x65,
0x78,0x74, 0x2F, 0x70, 0x6C, 0x61, 0x69, 0x6E,

//0x43,0x6f,0x6e,0x74,0x65,0x6e,0x74,0x2d,0x74,0x79,0x70,0x65,0x3a,0x20,0x69,0x6d,
//0x61,0x67,0x65,0x2f,0x6a,0x70,0x65,0x67,

0x0d,0x0a//,0x0d,0x0a
};


/* Private function prototypes -----------------------------------------------*/
/* Private functions ---------------------------------------------------------*/

/**
  * @brief serve tcp connection  
  * @param conn: pointer on connection structure 
  * @retval None
  */
void http_server_serve(struct netconn *conn) 
{
  struct netbuf *inbuf;
  char* buf;
  u16_t buflen;
  struct fs_file * file;
  
  /* Read the data from the port, blocking if nothing yet there. 
   We assume the request (the part we care about) is in one netbuf */
  inbuf = netconn_recv(conn);
  
  if (inbuf != NULL)
  {
    if (netconn_err(conn) == ERR_OK) 
    {
      netbuf_data(inbuf, (void**)&buf, &buflen);
    
      /* Is this an HTTP GET command? (only check the first 5 chars, since
      there are other formats for GET, and we're keeping it very simple )*/
      if ((buflen >=5) && (strncmp(buf, "GET /", 5) == 0))
      {
        /* Check if request to get ST.gif */ 
        if (strncmp((char const *)buf,"GET /STM32F4x7_files/ST.gif",27)==0)
        {
          file = fs_open("/STM32F4x7_files/ST.gif"); 
          netconn_write(conn, (const unsigned char*)(file->data), (size_t)file->len, NETCONN_NOCOPY);
          fs_close(file);
        }   
        /* Check if request to get stm32.jpeg */
        else if (strncmp((char const *)buf,"GET /STM32F4x7_files/stm32.jpg",30)==0)
        {
          file = fs_open("/STM32F4x7_files/stm32.jpg"); 
          netconn_write(conn, (const unsigned char*)(file->data), (size_t)file->len, NETCONN_NOCOPY);
          fs_close(file);
        }
        else if (strncmp((char const *)buf,"GET /STM32F4x7_files/logo.jpg", 29) == 0)                                           
        {
          /* Check if request to get ST logo.jpg */
          file = fs_open("/STM32F4x7_files/logo.jpg"); 
          netconn_write(conn, (const unsigned char*)(file->data), (size_t)file->len, NETCONN_NOCOPY);
          fs_close(file);
        }
        else if(strncmp(buf, "GET /tasks", 10) == 0)
        {
           /* Load dynamic page */
           DynWebPage_tasks(conn);
        }
        else if((strncmp(buf, "GET /STM32F4x7.html", 19) == 0))
        {
          /* Load STM32F4x7 page */
          file = fs_open("/STM32F4x7.html"); 
          netconn_write(conn, (const unsigned char*)(file->data), (size_t)file->len, NETCONN_NOCOPY);
          fs_close(file);
        }
        else if((strncmp(buf, "GET /main", 9) == 0)||(strncmp(buf, "GET / ", 6) == 0))
        {
        	DynWebPage_Main(conn);
        }
        else if((strncmp(buf, "GET /io", 7) == 0))
        {
        	DynWebPage_IO(conn,&buf[7]);
        }
        else if((strncmp(buf, "GET /download", 13) == 0))
        {
        	DynWebPage_download_day(conn, &buf[13]);
        }


        else if(strncmp(buf, "GET /sensors", 12) == 0)
        {
        	/* Load dynamic page */
        	DynWebPage_Temperature(conn,&buf[12]);
        }
        else 
        {
          /* Load Error page */
          file = fs_open("/404.html"); 
          netconn_write(conn, (const unsigned char*)(file->data), (size_t)file->len, NETCONN_NOCOPY);
          fs_close(file);
        }
      }      
    }
  }
  /* Close the connection (server closes in HTTP) */
  netconn_close(conn);
  
  /* Delete the buffer (netconn_recv gives us ownership,
   so we have to make sure to deallocate the buffer) */
  netbuf_delete(inbuf);
}


/**
  * @brief  http server thread 
  * @param arg: pointer on argument(not used here) 
  * @retval None
  */
static void http_server_netconn_thread(void *arg)
{ 
  struct netconn *conn, *newconn;
  err_t err;
  
  /* Create a new TCP connection handle */
  conn = netconn_new(NETCONN_TCP);
  
  if (conn!= NULL)
  {
    /* Bind to port 80 (HTTP) with default IP address */
    err = netconn_bind(conn, NULL, 80);
    
    if (err == ERR_OK)
    {
      /* Put the connection into LISTEN state */
      netconn_listen(conn);
  
      while(1) 
      {
        /* accept any icoming connection */
        newconn = netconn_accept(conn);
      
        /* serve connection */
        http_server_serve(newconn);
      
        /* delete connection */
        netconn_delete(newconn);
      }
    }
    else
    {
      //printf("can not bind netconn");
    }
  }
  else
  {
   // printf("can not create netconn");
  }
}

/**
  * @brief  Initialize the HTTP server (start its thread) 
  * @param  none
  * @retval None
  */
void http_server_netconn_init()
{
  sys_thread_new("HTTP", http_server_netconn_thread, NULL, DEFAULT_THREAD_STACKSIZE*4, WEBSERVER_THREAD_PRIO);
}

void DynWebPage_tasks(struct netconn *conn)
{
	portCHAR PAGE_BODY[1024];
	portCHAR pagehits[10] = {0};

	/* Update the hit count */
	nPageHits++;
	sprintf(pagehits, "%d", nPageHits);


	memset(PAGE_BODY, 0,1024);

	strcat((char *)PAGE_BODY, "</head><body bgcolor=\"#f6f6f6\"><div id=\"container\">");

	// belka Menu
	DynWebPage_main_bar(4, (char *)PAGE_BODY);

	strcat((char *)PAGE_BODY, "<tr><td><div id=\"content\">\n<p>");

	//strcat(PAGE_BODY, pagehits);
	strcat((char *)PAGE_BODY, "<pre><br>Name          State  Priority  Stack   Num" );
	strcat((char *)PAGE_BODY, "<br>---------------------------------------------<br>");

	/* The list of tasks and their status */
	vTaskList((signed char *)(PAGE_BODY + strlen(PAGE_BODY)));
	strcat((char *)PAGE_BODY, "<br><br>---------------------------------------------");

	//vTaskGetRunTimeStats((signed char *)(PAGE_BODY + strlen(PAGE_BODY)));
	//strcat((char *)PAGE_BODY, "<br><br>--------");

	strcat((char *)PAGE_BODY, "<br>B : Blocked, R : Ready, D : Deleted, S : Suspended<br>");
	strcat((char *)PAGE_BODY, "</p>\n</div></td></tr>\n");

	//stopka
	DynWebPage_footer((char *)PAGE_BODY);

	netconn_write(conn, MY_PAGE_START, strlen((char*)MY_PAGE_START), NETCONN_COPY);
	netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
}




void DynWebPage_download_day(struct netconn *conn, char *get)
{
	uint8_t nr[8];
	uint8_t my_day[16];
	char *my_string;
	my_string = strtok (&get[1],"/ ");
	strcpy(nr, my_string);
	my_string = strtok (NULL,"/. ");
	strcpy(my_day, my_string);

	netconn_write(conn, download_txt_header, strlen((char*)download_txt_header), NETCONN_COPY);
	SD_read_download_day(nr, my_day, conn);

}

void DynWebPage_main_bar(uint8_t nr_pos, char *PAGE_BODY)
{
	// Header
	strcat((char *)PAGE_BODY, "<table><tr><td><div id=\"header\"><p>Obs&#322;uga standardu Ethernet w mikrokontrolerze STM32</p></div></td></tr>");

	strcat((char *)PAGE_BODY, "<tr><td><div id=\"navigation\"><ul>");
	if(nr_pos==1) 	strcat((char *)PAGE_BODY, "<li><p>Main</p></li>");
	else 			strcat((char *)PAGE_BODY, "<li><a href=\"/main\">Main</a></li>");

	if(nr_pos==2) 	strcat((char *)PAGE_BODY, "<li><p>Czujniki</p></li>");
	else 			strcat((char *)PAGE_BODY, "<li><a href=\"/sensors/1d/4\">Czujniki</a></li>");

	if(nr_pos==3) 	strcat((char *)PAGE_BODY, "<li><p>Kontrola I/O</p></li>");
	else 			strcat((char *)PAGE_BODY, "<li><a href=\"/io/gpio\">Kontrola I/O</a></li>");

	if(nr_pos==4) 	strcat((char *)PAGE_BODY, "<li><p>Procesy</p></li>");
	else 			strcat((char *)PAGE_BODY, "<li><a href=\"/tasks\">Procesy</a></li>");

	strcat((char *)PAGE_BODY, "</ul></div></td></tr>");
}

void DynWebPage_footer(char *PAGE_BODY)
{
	// Stopka
	strcat((char *)PAGE_BODY, "<tr><td><div id=\"footer\">Copyright in&#380;. Pawel Kajzer, 2014</div></td></tr></table></div></body>\n</html>");
}


void DynWebPage_sensors_bar(SD_Stat *sensors_info,char *per, char *PAGE_BODY,char *PAGE_BODY_BUFF)
{
	uint8_t x,y;

	if(strcmp(per, "day"))
	{

		strcat((char *)PAGE_BODY, "<tr><td><div id=\"content\"><div id=\"navigation2\"></a><ul>");

		for(x=1;x<=4;x++)
		{
			sprintf((char *)PAGE_BODY_BUFF, "<li><a href=\"/sensors/%s",per);
			strcat((char *)PAGE_BODY, (char *)PAGE_BODY_BUFF);
			for(y=1;y<=4;y++) {
				if(sensors_info[y].sensor_selected) {
					if(y==x) continue;
					sprintf((char *)PAGE_BODY_BUFF, "/%d",y);
					strcat((char *)PAGE_BODY, (char *)PAGE_BODY_BUFF);
				} else if(x==y) {
					sprintf((char *)PAGE_BODY_BUFF, "/%d",y);
					strcat((char *)PAGE_BODY, (char *)PAGE_BODY_BUFF);
				}
			}
			if(sensors_info[x].sensor_selected)
				sprintf((char *)PAGE_BODY_BUFF, "\" style=\"background:#383\">%s</a></li>",sensors_info[x].name);
			else
				sprintf((char *)PAGE_BODY_BUFF, "\">%s</a></li>",sensors_info[x].name);

			strcat((char *)PAGE_BODY, (char *)PAGE_BODY_BUFF);
		}

		strcat((char *)PAGE_BODY, "</ul></div></div></td></tr>");
	} // if

}


void DynWebPage_period_bar(struct netconn *conn, SD_Stat *sensors_info,char *per, char *PAGE_BODY,char *PAGE_BODY_BUFF)
{
	uint8_t x;
	uint8_t sensors_selected_ch[32];

	sensors_selected_ch[0]=0;
	PAGE_BODY[0]=0;

	if(strcmp(per, "day"))
	{
		for(x=1;x<=4;x++)
		{
			if(sensors_info[x].sensor_selected) {
				sprintf((char *)PAGE_BODY_BUFF, "/%d",x);
				strcat((char *)sensors_selected_ch, (char *)PAGE_BODY_BUFF);
			}
		}

		strcat((char *)PAGE_BODY, "<tr><td><div id=\"content\"><div id=\"navigation2\"><ul>");

		if(!strcmp(per, "1h")) {
				strcat((char *)PAGE_BODY,"<li><p>1h</p></li>");
		} else {
			sprintf((char *)PAGE_BODY_BUFF, "<li><a href=\"/sensors/1h%s\">1h</a></li>", sensors_selected_ch);
			strcat((char *)PAGE_BODY,(char *)PAGE_BODY_BUFF);
		}

		if(!strcmp(per, "2h")) {
			strcat((char *)PAGE_BODY,"<li><p>2h</p></li>");
		} else {
			sprintf((char *)PAGE_BODY_BUFF, "<li><a href=\"/sensors/2h%s\">2h</a></li>", sensors_selected_ch);
			strcat((char *)PAGE_BODY,(char *)PAGE_BODY_BUFF);
		}

		netconn_write(conn, PAGE_BODY, strlen((char*)PAGE_BODY), NETCONN_COPY);
		PAGE_BODY[0]=0;


		if(!strcmp(per, "1d")) {
			strcat((char *)PAGE_BODY,"<li><p>1d</p></li>");
		} else {
			sprintf((char *)PAGE_BODY_BUFF, "<li><a href=\"/sensors/1d%s\">1d</a></li>", sensors_selected_ch);
			strcat((char *)PAGE_BODY,(char *)PAGE_BODY_BUFF);
		}

		if(!strcmp(per, "3d")) {
			strcat((char *)PAGE_BODY,"<li><p>3d</p></li>");
		} else {
			sprintf((char *)PAGE_BODY_BUFF, "<li><a href=\"/sensors/3d%s\">3d</a></li>", sensors_selected_ch);
			strcat((char *)PAGE_BODY,(char *)PAGE_BODY_BUFF);
		}

		if(!strcmp(per, "7d")) {
			strcat((char *)PAGE_BODY,"<li><p>7d</p></li>");
		} else {
			sprintf((char *)PAGE_BODY_BUFF, "<li><a href=\"/sensors/7d%s\">7d</a></li>", sensors_selected_ch);
			strcat((char *)PAGE_BODY,(char *)PAGE_BODY_BUFF);
		}

		if(!strcmp(per, "1m")) {
			strcat((char *)PAGE_BODY,"<li><p>1m</p></li>");
		} else {
			sprintf((char *)PAGE_BODY_BUFF, "<li><a href=\"/sensors/1m%s\">1m</a></li>", sensors_selected_ch);
			strcat((char *)PAGE_BODY,(char *)PAGE_BODY_BUFF);
		}

		if(!strcmp(per, "3m")) {
			strcat((char *)PAGE_BODY,"<li><p>3m</p></li>");
		} else {
			sprintf((char *)PAGE_BODY_BUFF, "<li><a href=\"/sensors/3m%s\">3m</a></li>", sensors_selected_ch);
			strcat((char *)PAGE_BODY,(char *)PAGE_BODY_BUFF);
		}

		netconn_write(conn, PAGE_BODY, strlen((char*)PAGE_BODY), NETCONN_COPY);
		PAGE_BODY[0]=0;

		sprintf((char *)PAGE_BODY_BUFF, "<li><a href=\"/sensors/day/select%s\">wybierz dzie&#324;</a></li>", sensors_selected_ch);
		strcat((char *)PAGE_BODY,(char *)PAGE_BODY_BUFF);

		strcat((char *)PAGE_BODY, "</ul></div></div></td></tr>");
	}
}




void DynWebPage_IO(struct netconn *conn, char *get)
{
	// IO
	portCHAR PAGE_BODY[1024];
	uint8_t temp_ch[10];
	//portCHAR PAGE_BODY_BUFF[128];
	char *my_string;

	netconn_write(conn, MY_PAGE_START, strlen((char*)MY_PAGE_START), NETCONN_COPY);
	PAGE_BODY[0]=0;
	strcat((char *)PAGE_BODY, "</head><body bgcolor=\"#f6f6f6\"><div id=\"container\">" );

	//belka
	DynWebPage_main_bar(3, (char *)PAGE_BODY);

	strcat((char *)PAGE_BODY, "<tr><td><div id=\"content\"><div id=\"navigation2\"><ul><li>");



	netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
	PAGE_BODY[0]=0;

	if(get[0]=='/' && get[1]!=0)
	{
		my_string = strtok (&get[1],"/ ");
		printf("string1(%s) ",my_string);
		if(!strcmp(my_string, "adc")) {
			strcat((char *)PAGE_BODY, "<a href=\"/io/gpio\">GPIO</a></li><li><p>ADC</p>");
			strcat((char *)PAGE_BODY, "</li></ul></div><br>");
			strcat((char *)PAGE_BODY, "<div id=\"content\"><div id=\"navigation2\"><ul>");
			strcat((char *)PAGE_BODY, "<li><d>ADC: </d></li><li><p>");
			ADC_Handler(temp_ch);
			strcat((char *)PAGE_BODY, temp_ch);
			strcat((char *)PAGE_BODY, " mV</p></li><li><d>&nbsp;</d></li><li><a href=\"/io/adc\">Od&#347;wie&#380;</a></li>");
			strcat((char *)PAGE_BODY, "</ul></div><br><br></div>");
			netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
			PAGE_BODY[0]=0;

		} else {
			my_string = strtok (NULL,"/ ");
			printf("string2(%s) ",my_string);
			if(!strcmp(my_string, "led5")) {
				my_string = strtok (NULL,"/ ");
				printf("string3(%s) ",my_string);
				if(!strcmp(my_string, "on")) LED5_on();
				else if(!strcmp(my_string, "off")) LED5_off();
			} else if(!strcmp(my_string, "out1")) {
				my_string = strtok (NULL,"/ ");
				printf("string3(%s) ",my_string);
				if(!strcmp(my_string, "set")) OUT1_on();
				else if(!strcmp(my_string, "reset")) OUT1_off();
			} else if(!strcmp(my_string, "out2")) {
				my_string = strtok (NULL,"/ ");
				printf("string3(%s) ",my_string);
				if(!strcmp(my_string, "set")) OUT2_on();
				else if(!strcmp(my_string, "reset")) OUT2_off();
			}

			strcat((char *)PAGE_BODY, "<p>GPIO</p></li><li><a href=\"/io/adc\">ADC</a>");
			strcat((char *)PAGE_BODY, "</li></ul></div><br><div id=\"content\">");

			strcat((char *)PAGE_BODY, "<div id=\"navigation2\"><ul><li><d>Stan diody LED5: </d></li>");
			strcat((char *)PAGE_BODY, "<li><d><b>");

			if(LED5_status())
				strcat((char *)PAGE_BODY, "ON");
			else
				strcat((char *)PAGE_BODY, "OFF");

			strcat((char *)PAGE_BODY, "</b></d></li><li><a href=\"/io/gpio/led5/on\">ON</a></li>");
			strcat((char *)PAGE_BODY, "<li><a href=\"/io/gpio/led5/off\">OFF</a></li>");
			strcat((char *)PAGE_BODY, "<li><d>&nbsp;</d></li><li><a href=\"/io/gpio\">Od&#347;wie&#380;</a></li>");
			strcat((char *)PAGE_BODY, "</ul></div><br><br><div id=\"navigation2\"><ul>");
			strcat((char *)PAGE_BODY, "<li><d>Stan wyj&#347;cia OUT1: </d></li><li><d><b>");

			if(OUT1_status())
				strcat((char *)PAGE_BODY, "1");
			else
				strcat((char *)PAGE_BODY, "0");

			strcat((char *)PAGE_BODY, "</b></d></li><li><a href=\"/io/gpio/out1/set\">SET</a></li>");
			netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
			PAGE_BODY[0]=0;

			strcat((char *)PAGE_BODY, "<li><a href=\"/io/gpio/out1/reset\">RESET</a></li>");
			strcat((char *)PAGE_BODY, "</ul></div><br><br><div id=\"navigation2\"><ul>");
			strcat((char *)PAGE_BODY, "<li><d>Stan wyj&#347;cia OUT2: </d></li><li><d><b>");

			if(OUT2_status())
				strcat((char *)PAGE_BODY, "1");
			else
				strcat((char *)PAGE_BODY, "0");

			strcat((char *)PAGE_BODY, "</b></d></li><li><a href=\"/io/gpio/out2/set\">SET</a></li>");
			strcat((char *)PAGE_BODY, "<li><a href=\"/io/gpio/out2/reset\">RESET</a></li>");
			strcat((char *)PAGE_BODY, "</ul></div><br><br><div id=\"navigation2\"><ul>");
			strcat((char *)PAGE_BODY, "<li><d>Stan wej&#347;cia IN1: </d></li>");
			strcat((char *)PAGE_BODY, "<li><d><b>");

			if(IN1_status())
				strcat((char *)PAGE_BODY, "1");
			else
				strcat((char *)PAGE_BODY, "0");

			strcat((char *)PAGE_BODY, "</b></d></li></ul></div><br><br></div></div></td></tr>");

			netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
			PAGE_BODY[0]=0;

		}
	}

	DynWebPage_footer((char *)PAGE_BODY);
	//strcat((char *)PAGE_BODY, "<div id=\"footer\">Copyright <a href=\"mailto:pawelkajzer@gmail.com\">Pawel Kajzer</a>, 2014</div></div></body></html>");
	netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
}

void DynWebPage_Temperature(struct netconn *conn, char *get)
{
	portCHAR PAGE_BODY[1024];
	portCHAR PAGE_BODY_BUFF[128];

	uint8_t i, error, nr_czujnika=0, day_select=0;
	char *my_string;
	char per[4];
	SD_Stat sensors_info[5];
	//portCHAR pagehits[10] = {0};

	for(i=1;i<=4;i++)
		strcpy(sensors_info[i].name, "Czujnik bez nazwy");
	SD_read_Sensors_Names(&sensors_info, &error);

	netconn_write(conn, MY_PAGE_START, strlen((char*)MY_PAGE_START), NETCONN_COPY);

	memset(PAGE_BODY, 0,1024);
	PAGE_BODY[0]=0;

	netconn_write(conn, CHART_START, strlen((char*)CHART_START), NETCONN_COPY);

		if(get[0]=='/' && get[1]!=0)
		{
			my_string = strtok (&get[1],"/ ");
			printf("string1-(%s) ",my_string);

			if(!strcmp(my_string, "day")) {
				strcpy(per, my_string); // dla belki nawigacyjnej
				my_string = strtok (NULL,"/ ");
				printf("string3-(%s) ",my_string);
				if(!strcmp(my_string, "select")) {
					day_select=1;
				} else {
					SD_read_temperature_day(my_string, conn, &sensors_info);
				}
			} else {
				//printf("(4)\n\r");
				if(!strcmp(my_string, "1h")) strcpy(per, my_string);
				else if(!strcmp(my_string, "2h")) strcpy(per, my_string);
				else if(!strcmp(my_string, "1d")) strcpy(per, my_string);
				else if(!strcmp(my_string, "2d")) strcpy(per, my_string);
				else if(!strcmp(my_string, "3d")) strcpy(per, my_string);
				else if(!strcmp(my_string, "7d")) strcpy(per, my_string);
				else if(!strcmp(my_string, "1m")) strcpy(per, my_string);
				else if(!strcmp(my_string, "3m")) strcpy(per, my_string);
				else if(!strcmp(my_string, "6m")) strcpy(per, my_string);
				else if(!strcmp(my_string, "1y")) strcpy(per, my_string);
				else strcpy(per, "1d");

				for(i=1;i<=4;i++)
					sensors_info[i].sensor_selected=0;
				for(i=1;i<=4;i++)
				{
					printf("for%d (%s)\n\r",i,my_string);
					my_string = strtok (NULL,"/ ");
					if(strlen(my_string)>2) break;
					if(!strcmp(my_string, "1")) { sensors_info[1].sensor_selected=1; printf("s1 selected\n\r");}
					else if(!strcmp(my_string, "2")) {sensors_info[2].sensor_selected=1; printf("s2 selected\n\r");}
					else if(!strcmp(my_string, "3")) {sensors_info[3].sensor_selected=1; printf("s3 selected\n\r");}
					else if(!strcmp(my_string, "4")) {sensors_info[4].sensor_selected=1; printf("s4 selected\n\r");}

				}

				SD_read_temperature(per, conn, &sensors_info, &error);
			}
		}



	strcat((char *)PAGE_BODY, "]});});</script>");


	strcat((char *)PAGE_BODY, "</head><body bgcolor=\"#f6f6f6\"><div id=\"container\">" );
	netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
	PAGE_BODY[0]=0;

	// Belka
	DynWebPage_main_bar(2, (char *)PAGE_BODY);
	netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
	PAGE_BODY[0]=0;

	DynWebPage_sensors_bar(&sensors_info,per,PAGE_BODY,PAGE_BODY_BUFF);


	strcat((char *)PAGE_BODY, "<tr><td><div ");

	if(day_select)
		strcat((char *)PAGE_BODY, "id=\"content\"");
	else
		strcat((char *)PAGE_BODY, "id=\"div_chart\"");


	strcat((char *)PAGE_BODY, " style=\"text-align: center; width: 1000; min-height: 500px;\">");
	netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
	PAGE_BODY[0]=0;

	if(day_select) {
		SD_day_select(&sensors_info, conn);
		PAGE_BODY[0]=0;
	} else if(sensors_info[nr_czujnika].count_in_database <= 0)
		strcat((char *)PAGE_BODY, "<br><br><br>Brak danych do wy&#347;wietlenia, sprawd&#378; czy ten czujnik jest pod&#322;&#261;czony");

	strcat((char *)PAGE_BODY, "</div></td></tr>");
	netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
	PAGE_BODY[0]=0;

	DynWebPage_period_bar(conn, &sensors_info, per,PAGE_BODY,PAGE_BODY_BUFF);
	netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
	PAGE_BODY[0]=0;

	//strcat((char *)PAGE_BODY, "</div>");
	//strcat((char *)PAGE_BODY, "Copyright Pawel Kajzer, 2014");
	//strcat((char *)PAGE_BODY, "</div></div></body></html>");
	DynWebPage_footer((char *)PAGE_BODY);

	netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
}




void DynWebPage_Main(struct netconn *conn)
{
	portCHAR PAGE_BODY[1024];
	portCHAR pagehits[10] = {0};
	uint32_t PowerOnTime, lastSNTPupdate;
	uint8_t days, hours, minutes, seconds;
	uint8_t hoursLA, minutesLA, secondsLA;
	uint8_t date_ch[10], time_ch[10];


	RTC_GetTime_char(time_ch);
	RTC_GetDate_char(date_ch);


	netconn_write(conn, MY_PAGE_START, strlen((char*)MY_PAGE_START), NETCONN_COPY);

	memset(PAGE_BODY, 0,1024);

	strcat((char *)PAGE_BODY, "</head><body bgcolor=\"#f6f6f6\"><div id=\"container\">");

	// belka
	DynWebPage_main_bar(1, (char *)PAGE_BODY);
	strcat((char *)PAGE_BODY, "<tr><td><div id=\"content\">\n");

	netconn_write(conn, PAGE_BODY, strlen((char*)PAGE_BODY), NETCONN_COPY);
	sprintf((char *)PAGE_BODY, "<p>Godzina: %s </p><p>Data: %s</p>", time_ch, date_ch );
	netconn_write(conn, PAGE_BODY, strlen((char*)PAGE_BODY), NETCONN_COPY);


	if(xQueueReceive(powerontime_queue, &PowerOnTime, 500)) {
		seconds=PowerOnTime%60;
		PowerOnTime/=60;
		minutes=PowerOnTime%60;
		PowerOnTime/=60;
		hours=PowerOnTime%24;
		PowerOnTime/=24;
		days=PowerOnTime;
		sprintf((char *)PAGE_BODY, "<p>System dzia&#322;a: %d dni %d godzin %d minut %d sekund</p>", days, hours, minutes, seconds );
		netconn_write(conn, PAGE_BODY, strlen((char*)PAGE_BODY), NETCONN_COPY);
	}

	if(xQueueReceive(last_sntp_response_queue, &lastSNTPupdate, 200)) {
		secondsLA=lastSNTPupdate%60;
		lastSNTPupdate/=60;
		minutesLA=lastSNTPupdate%60;
		lastSNTPupdate/=60;
		hoursLA=lastSNTPupdate;

		sprintf((char *)PAGE_BODY, "<p>Ostatnia aktualizacja czasu z serwera NTP: %d godzin %d minut %d sekund temu</p>", hoursLA, minutesLA, secondsLA );
		netconn_write(conn, PAGE_BODY, strlen((char*)PAGE_BODY), NETCONN_COPY);
	}

	//stopka
	PAGE_BODY[0]=0;
	strcat((char *)PAGE_BODY, "\n</div></td></tr>\n");
	DynWebPage_footer((char *)PAGE_BODY);
	netconn_write(conn, PAGE_BODY, strlen(PAGE_BODY), NETCONN_COPY);
}
